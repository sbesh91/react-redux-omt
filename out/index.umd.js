!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@preact/signals-react"),require("use-deep-compare-effect")):"function"==typeof define&&define.amd?define(["exports","@preact/signals-react","use-deep-compare-effect"],t):t((e||self).reactReduxOmt={},e.signalsReact,e.useDeepCompareEffect)}(this,function(e,t,a){function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var u,i=/*#__PURE__*/n(a),r=new t.Signal(null),s=new Map;e.createWorkerSelector=function(e,t){return{name:e,fn:t}},e.dispatch=function(e){var t;null==(t=u)||t.postMessage({type:"dispatch",action:e})},e.initializeWorkerStore=function(e,t){function a(a,n){var u,i=null==t||null==(u=t[a.selector])?void 0:u.fn,r=a.params;if(i){var s=i.apply(void 0,[e.getState()].concat(r));postMessage({uuid:n,value:s})}}addEventListener("message",function(t){var n=t.data;switch(n.type){case"dispatch":e.dispatch(n.action);break;case"subscribe":s.set(n.uuid,n.selector),a(n.selector,n.uuid);break;case"unsubscribe":s.delete(n.uuid)}}),e.subscribe(function(){s.forEach(a)})},e.initializeWorkerStoreListener=function(e){u=e,e.addEventListener("message",function(e){r.value=e.data})},e.useWorkerSelector=function(e,a){var n=null==a?void 0:a.defaultValue,s=a&&"params"in a?a.params:[],o=t.useSignal(""),c=t.useSignal(n);return t.useSignalEffect(function(){var e=r.value;e&&e.uuid===o.peek()&&(c.value=e.value)}),i.default(function(){var t,a=crypto.randomUUID();return o.value=a,null==(t=u)||t.postMessage({type:"subscribe",uuid:a,selector:{selector:e.name,params:s}}),function(){var e;null==(e=u)||e.postMessage({type:"unsubscribe",uuid:a})}},[e,s]),c}});
//# sourceMappingURL=index.umd.js.map
